<!-- Realizado por Alexandra Hurtado -->
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<div class="container mt-5">
    <h2 class="fw-bold mb-4">{% trans "Mis Pedidos" %}</h2>

    {% if pedidos %}
        <div class="row g-4">
            {% for pedido in pedidos %}
                <div class="col-md-6 col-lg-4">
                    <div class="card shadow-sm rounded-4 h-100" style="background-color: #fffdf3;">
                        <div class="card-header fw-bold text-dark" 
                             style="background: linear-gradient(90deg, #FFEE8C, #fff7c2); border-top-left-radius: 1rem; border-top-right-radius: 1rem;">
                            {% blocktrans %}Pedido #{{ pedido.id }}{% endblocktrans %}
                        </div>
                        <div class="card-body d-flex flex-column">
                            <p><strong>{% trans "Dirección:" %}</strong> {{ pedido.usuario.direccion }}</p>
                            <p><strong>{% trans "Fecha:" %}</strong> {{ pedido.fecha }}</p>
                            <p class="fw-bold"><strong>{% trans "Total:" %}</strong> ${{ pedido.total }}</p>
                            
                            <!-- Estado del Pedido -->
                            <p><strong>{% trans "Estado del Pedido:" %}</strong> 
                                <span class="fw-semibold px-2 py-1 rounded-pill" 
                                      style="background-color: #d1c17d; color: #3a2e00;">
                                    {{ pedido.estado|capfirst }}
                                </span>
                            </p>

                            <!-- Estado del Pago -->
                            <p><strong>{% trans "Estado del Pago:" %}</strong> 
                                {% if pedido.pago.estado|lower == "pendiente" %}
                                    <span class="fw-semibold px-2 py-1 rounded-pill" style="background-color: #f7a500; color: #fff;">
                                        {{ pedido.pago.estado|capfirst }}
                                    </span>
                                {% elif pedido.pago.estado|lower == "pagado" %}
                                    <span class="fw-semibold px-2 py-1 rounded-pill" style="background-color: #2e7d32; color: #fff;">
                                        {{ pedido.pago.estado|capfirst }}
                                    </span>
                                {% else %}
                                    <span class="fw-semibold px-2 py-1 rounded-pill" style="background-color: #ccc; color: #333;">
                                        {{ pedido.pago.estado|capfirst }}
                                    </span>
                                {% endif %}
                            </p>

                            <!-- Botón de acción -->
                            <div class="mt-auto">
                                {% if pedido.pago.estado|lower == "pendiente" %}
                                    <a href="{% url 'pedidos:pagar_pedido' pedido.id %}" 
                                       class="btn rounded-pill w-100 fw-semibold"
                                       style="background: linear-gradient(90deg, #f5d442, #f0b90b); border: none; color: #3a2e00; transition: 0.3s;">
                                        {% trans "Ir a Pagar" %}
                                    </a>
                                {% else %}
                                    <a href="{% url 'pedidos:pedido_pdf' pedido.id %}" 
                                       class="btn rounded-pill w-100 fw-semibold"
                                       style="background: linear-gradient(90deg, #f5d442, #f0b90b); border: none; color: #3a2e00; transition: 0.3s;">
                                        {% trans "Descargar PDF" %}
                                    </a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p class="text-center text-muted">{% trans "No tienes pedidos todavía." %}</p>
    {% endif %}
</div>
{% endblock %}
